<!DOCTYPE html>

<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">


		<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Merriweather:400,400italic,700,700italic|Open+Sans:400,400italic,600,600italic,700,700italic|Inconsolata:400,700">
		<link rel="stylesheet" href="/docs/css/main.css">
		<link rel="apple-touch-icon" href="/docs/images/apple-touch-icon.png">
		<link rel="icon" type="image/png" href="/docs/images/touch-icon.png" sizes="192x192">
		<link rel="icon" type="image/png" href="/docs/images/favicon.png">

		
	</head>

	<body>
		<header>
			<h1>
				<a href="/docs/"><img src="/docs/images/emblem.svg" width="40" height="40" alt="ATD文档中心 logo"></a>
				ATD文档中心
				<button type="button" class="open-nav" id="open-nav"></button>
			</h1>
			<!--
			<form action="/docs/search/" method="get">
				<input type="text" name="q" id="search-input" placeholder="搜索" autofocus>
				<input type="submit" value="search" style="display: none;">
			</form>
		-->
			<nav class="full-navigation">
				<ul>
					<li class="nav-item top-level ">
						
						<a href="/docs/">ATD新手入门文档</a>
					</li>
				</ul>

				<ul>
					
					
						<li class="nav-item "><a href="/docs/%E9%AB%98%E7%BA%A7%E8%AE%A1%E7%AE%97%E6%A8%A1%E5%BC%8F%E7%9A%84%E7%AD%96%E7%95%A5%E8%AE%BE%E7%BD%AE/">高级计算模式的策略设置</a></li>
					
						<li class="nav-item "><a href="/docs/%E9%AB%98%E7%BA%A7%E6%90%9C%E7%B4%A2%E8%AF%B4%E6%98%8E%E6%96%87%E6%A1%A3/">高级搜索说明文档</a></li>
					
						<li class="nav-item "><a href="/docs/%E5%87%A0%E7%A7%8D%E6%8E%A8%E6%97%A5%E5%BF%97%E6%96%B9%E5%BC%8F%E4%BB%8B%E7%BB%8D/">几种推日志方式介绍</a></li>
					
						<li class="nav-item "><a href="/docs/%E5%8F%AF%E7%BC%96%E7%A8%8B%E5%AF%B9%E6%8A%97-%E9%AB%98%E7%BA%A7%E8%A7%84%E5%88%99/">可编程对抗-高级规则</a></li>
					
						<li class="nav-item "><a href="/docs/%E5%8F%AF%E7%BC%96%E7%A8%8B%E5%AF%B9%E6%8A%97%E6%A8%A1%E5%9E%8B%E8%AF%B4%E6%98%8E%E6%96%87%E6%A1%A3/">可编程对抗模型说明文档</a></li>
					
						<li class="nav-item "><a href="/docs/%E8%BD%AE%E8%AF%A2%E5%91%A8%E6%9C%9F%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3/">轮询周期使用文档</a></li>
					
						<li class="nav-item current"><a href="/docs/%E5%86%85%E7%BD%91%E8%87%AA%E5%AE%9A%E4%B9%89%E5%A4%84%E7%90%86%E6%8E%A5%E5%8F%A3%E6%96%87%E6%A1%A3/">内网自定义处理接口文档</a></li>
					
						<li class="nav-item "><a href="/docs/%E6%97%A5%E5%BF%97%E9%85%8D%E7%BD%AE%E6%96%87%E6%A1%A3/">日志配置文档</a></li>
					
						<li class="nav-item "><a href="/docs/%E7%AE%97%E6%B3%95%E6%A8%A1%E5%9E%8B%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3/">算法模型开发文档</a></li>
					
						<li class="nav-item "><a href="/docs/%E5%BE%AE%E4%BF%A1%E5%91%8A%E8%AD%A6%E5%AF%B9%E6%8E%A5%E6%93%8D%E4%BD%9C%E6%96%87%E6%A1%A3/">微信告警对接操作文档</a></li>
					
						<li class="nav-item "><a href="/docs/%E9%92%89%E9%92%89%E5%91%8A%E8%AD%A6%E5%AF%B9%E6%8E%A5%E6%93%8D%E4%BD%9C%E6%96%87%E6%A1%A3/">钉钉告警对接操作文档</a></li>
					
						<li class="nav-item "><a href="/docs/%E8%BF%90%E8%A1%8C%E7%8E%AF%E5%A2%83%E8%87%AA%E5%8A%A8%E8%B0%83%E6%95%B4%E6%8E%A5%E5%8F%A3%E6%96%87%E6%A1%A3/">运行环境自动调整接口文档</a></li>
					
						<li class="nav-item "><a href="/docs/%E6%89%A7%E8%A1%8C%E5%8A%A8%E4%BD%9C%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3/">执行动作使用文档</a></li>
					
						<li class="nav-item "><a href="/docs/%E6%99%BA%E8%83%BD%E6%97%A5%E5%BF%97%E8%A7%A3%E6%9E%90/">智能日志解析</a></li>
					
						<li class="nav-item "><a href="/docs/%E8%B5%84%E4%BA%A7%E5%8F%91%E7%8E%B0/">资产发现</a></li>
					
						<li class="nav-item "><a href="/docs/%E8%87%AA%E5%AE%9A%E4%B9%89%E5%A4%84%E7%90%86%E6%96%B9%E5%BC%8F%E6%8E%A5%E5%8F%A3%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3/">自定义处理方式接口开发文档</a></li>
					
						<li class="nav-item "><a href="/docs/%E6%94%BB%E5%87%BB%E7%B1%BB%E5%9E%8B/">攻击类型</a></li>
					
						<li class="nav-item "><a href="/docs/FAQ/">FAQ</a></li>
					
				</ul>

			</nav>
		</header>

		<section class="main">
			<div class="page-header">
				<h2>ATD文档中心</h2>
				<h3>内网自定义处理接口文档</h3>
			</div>
			<article class="content">
				<h3 id="通用说明">通用说明</h3>
<blockquote>
  <p>接口以POST方式调用，body格式为json。</p>
</blockquote>

<h3 id="1-request-body数据样例">1. request body数据样例</h3>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[{</span><span class="w">
    </span><span class="nl">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="mi">1589990781</span><span class="p">,</span><span class="w">
    </span><span class="nl">"location"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.10.17.2"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nl">"event"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Misc攻击"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bro"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"reason"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Misc攻击"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ET CHAT IRC PING command"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"policy"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nl">"level"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
        </span><span class="nl">"rule"</span><span class="p">:</span><span class="w"> </span><span class="s2">"alert tcp any 6666:7000 -&gt; any any (msg:</span><span class="se">\"</span><span class="s2">ET CHAT IRC PING command</span><span class="se">\"</span><span class="s2">; flow:from_server,established; content:</span><span class="se">\"</span><span class="s2">PING|20|</span><span class="se">\"</span><span class="s2">; flowbits:set,is_proto_irc; reference:url,doc.emergingthreats.net/2002027; classtype:misc-activity; sid:2002027; rev:16; metadata:created_at 2010_07_30, updated_at 2010_07_30;)"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"content"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"destIP"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.47.7.152"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"destPort"</span><span class="p">:</span><span class="w"> </span><span class="mi">50981</span><span class="p">,</span><span class="w">
            </span><span class="nl">"illegalIP"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.10.17.2"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"proto"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TCP"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"srcIP"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.10.17.2"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"srcPort"</span><span class="p">:</span><span class="w"> </span><span class="mi">6667</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"suspicious_text"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="s2">"PING "</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"time_local"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-05-21T00:06:21+0800"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"ip_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{</span><span class="se">\"</span><span class="s2">is_legal</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">yes</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">is_local</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">yes</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">latest</span><span class="se">\"</span><span class="s2">: [], </span><span class="se">\"</span><span class="s2">trend</span><span class="se">\"</span><span class="s2">: [[1587312000, 0, null], [1587398400, 0, null]], </span><span class="se">\"</span><span class="s2">score</span><span class="se">\"</span><span class="s2">: null, </span><span class="se">\"</span><span class="s2">ip</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">10.10.17.2</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">addr</span><span class="se">\"</span><span class="s2">: [], </span><span class="se">\"</span><span class="s2">search_engine</span><span class="se">\"</span><span class="s2">: {</span><span class="se">\"</span><span class="s2">name</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">status</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"\"</span><span class="s2">}, </span><span class="se">\"</span><span class="s2">credit</span><span class="se">\"</span><span class="s2">: {</span><span class="se">\"</span><span class="s2">is_local</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">yes</span><span class="se">\"</span><span class="s2">}, </span><span class="se">\"</span><span class="s2">services</span><span class="se">\"</span><span class="s2">: [], </span><span class="se">\"</span><span class="s2">tag_list</span><span class="se">\"</span><span class="s2">: [], </span><span class="se">\"</span><span class="s2">ports</span><span class="se">\"</span><span class="s2">: [], </span><span class="se">\"</span><span class="s2">type</span><span class="se">\"</span><span class="s2">: {}, </span><span class="se">\"</span><span class="s2">export_score</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">60</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">cache_at</span><span class="se">\"</span><span class="s2">: 1589958140}"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"ip_tag"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"local"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"src_ip_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{</span><span class="se">\"</span><span class="s2">is_legal</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">yes</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">is_local</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">yes</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">latest</span><span class="se">\"</span><span class="s2">: [], </span><span class="se">\"</span><span class="s2">trend</span><span class="se">\"</span><span class="s2">: [[1587312000, 0, null], [1587398400, 0, null]], </span><span class="se">\"</span><span class="s2">score</span><span class="se">\"</span><span class="s2">: null, </span><span class="se">\"</span><span class="s2">ip</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">10.10.17.2</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">addr</span><span class="se">\"</span><span class="s2">: [], </span><span class="se">\"</span><span class="s2">search_engine</span><span class="se">\"</span><span class="s2">: {</span><span class="se">\"</span><span class="s2">name</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">status</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"\"</span><span class="s2">}, </span><span class="se">\"</span><span class="s2">credit</span><span class="se">\"</span><span class="s2">: {</span><span class="se">\"</span><span class="s2">is_local</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">yes</span><span class="se">\"</span><span class="s2">}, </span><span class="se">\"</span><span class="s2">services</span><span class="se">\"</span><span class="s2">: [], </span><span class="se">\"</span><span class="s2">tag_list</span><span class="se">\"</span><span class="s2">: [], </span><span class="se">\"</span><span class="s2">ports</span><span class="se">\"</span><span class="s2">: [], </span><span class="se">\"</span><span class="s2">type</span><span class="se">\"</span><span class="s2">: {}, </span><span class="se">\"</span><span class="s2">export_score</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">60</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">cache_at</span><span class="se">\"</span><span class="s2">: 1589958140}"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"src_ip_tag"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"local"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"dst_ip_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{</span><span class="se">\"</span><span class="s2">is_legal</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">yes</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">is_local</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">yes</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">latest</span><span class="se">\"</span><span class="s2">: [], </span><span class="se">\"</span><span class="s2">trend</span><span class="se">\"</span><span class="s2">: [[1587312000, 0, null], [1587398400, 0, null]], </span><span class="se">\"</span><span class="s2">score</span><span class="se">\"</span><span class="s2">: null, </span><span class="se">\"</span><span class="s2">ip</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">10.47.7.152</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">addr</span><span class="se">\"</span><span class="s2">: [], </span><span class="se">\"</span><span class="s2">search_engine</span><span class="se">\"</span><span class="s2">: {</span><span class="se">\"</span><span class="s2">name</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">status</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"\"</span><span class="s2">}, </span><span class="se">\"</span><span class="s2">credit</span><span class="se">\"</span><span class="s2">: {</span><span class="se">\"</span><span class="s2">is_local</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">yes</span><span class="se">\"</span><span class="s2">}, </span><span class="se">\"</span><span class="s2">services</span><span class="se">\"</span><span class="s2">: [], </span><span class="se">\"</span><span class="s2">tag_list</span><span class="se">\"</span><span class="s2">: [], </span><span class="se">\"</span><span class="s2">ports</span><span class="se">\"</span><span class="s2">: [], </span><span class="se">\"</span><span class="s2">type</span><span class="se">\"</span><span class="s2">: {}, </span><span class="se">\"</span><span class="s2">export_score</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">60</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">cache_at</span><span class="se">\"</span><span class="s2">: 1589958140}"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"dst_ip_tag"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"local"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"direction"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PRIVATE_PRIVATE"</span><span class="w">
</span><span class="p">}]</span><span class="w">
</span></code></pre></div></div>

<p><strong>字段解释：</strong></p>

<table>
  <thead>
    <tr>
      <th>字段名</th>
      <th>类型</th>
      <th>取值范围</th>
      <th>说明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>timestamp</td>
      <td>int</td>
      <td>-</td>
      <td>unix 时间戳</td>
    </tr>
    <tr>
      <td>location</td>
      <td>string</td>
      <td>-</td>
      <td>主机IP地址</td>
    </tr>
    <tr>
      <td>action</td>
      <td>string</td>
      <td>-</td>
      <td>处理动作</td>
    </tr>
    <tr>
      <td>event</td>
      <td>object</td>
      <td>-</td>
      <td>威胁事件数据</td>
    </tr>
    <tr>
      <td>event.name</td>
      <td>string</td>
      <td>-</td>
      <td>攻击名称</td>
    </tr>
    <tr>
      <td>event.type</td>
      <td>string</td>
      <td>-</td>
      <td>流量转换方式</td>
    </tr>
    <tr>
      <td>event.reason</td>
      <td>string</td>
      <td>-</td>
      <td>威胁事件的原因</td>
    </tr>
    <tr>
      <td>event.description</td>
      <td>string</td>
      <td>-</td>
      <td>威胁事件的描述</td>
    </tr>
    <tr>
      <td>event.policy</td>
      <td>int</td>
      <td>-</td>
      <td>命中规则的ID</td>
    </tr>
    <tr>
      <td>event.level</td>
      <td>int</td>
      <td>[1-5]</td>
      <td>威胁事件的等级</td>
    </tr>
    <tr>
      <td>event.rule</td>
      <td>string</td>
      <td>-</td>
      <td>威胁事件命中的规则内容</td>
    </tr>
    <tr>
      <td>event.content</td>
      <td>object</td>
      <td>-</td>
      <td>流量的原始内容,字段不等</td>
    </tr>
    <tr>
      <td>event.content.destIP</td>
      <td>string</td>
      <td>-</td>
      <td>目的IP</td>
    </tr>
    <tr>
      <td>event.content.destPort</td>
      <td>int</td>
      <td>-</td>
      <td>目的端口</td>
    </tr>
    <tr>
      <td>event.content.illegalIP</td>
      <td>string</td>
      <td>-</td>
      <td>非法IP</td>
    </tr>
    <tr>
      <td>event.content.proto</td>
      <td>string</td>
      <td>-</td>
      <td>协议</td>
    </tr>
    <tr>
      <td>event.content.srcIP</td>
      <td>string</td>
      <td>-</td>
      <td>源IP</td>
    </tr>
    <tr>
      <td>event.content.srcPort</td>
      <td>int</td>
      <td>-</td>
      <td>原端口</td>
    </tr>
    <tr>
      <td>event.suspicious_text</td>
      <td>array</td>
      <td>-</td>
      <td>规则主要命中内容</td>
    </tr>
    <tr>
      <td>time_local</td>
      <td>string</td>
      <td>-</td>
      <td>格式化后的时间</td>
    </tr>
    <tr>
      <td>ip_credit</td>
      <td>object</td>
      <td>-</td>
      <td>IP信⽤等级数据，json格式，需解析，等同于 src_ip_credit和 dst_ip_credit</td>
    </tr>
    <tr>
      <td>ip_credit.is_local</td>
      <td>enum</td>
      <td>[“yes”,”no”]</td>
      <td>是否为内网IP</td>
    </tr>
    <tr>
      <td>ip_credit.search_engine</td>
      <td>object</td>
      <td>-</td>
      <td>搜索引擎IP信息</td>
    </tr>
    <tr>
      <td>ip_credit.search_engine.status</td>
      <td>enum</td>
      <td>[“yes”,”no”,””]</td>
      <td>当前IP是否为健康的搜索引擎爬虫IP，”yes”：健康的搜索引擎IP，”no”：恶意的搜索引擎IP，”“：不是搜索引擎IP</td>
    </tr>
    <tr>
      <td>ip_credit.search_engine.name</td>
      <td>string</td>
      <td>-</td>
      <td>具体的搜索引擎名称</td>
    </tr>
    <tr>
      <td>ip_credit.is_near</td>
      <td>boolean</td>
      <td>[true,false]</td>
      <td>内部临时数据，可忽略</td>
    </tr>
    <tr>
      <td>ip_credit.addr</td>
      <td>array</td>
      <td>-</td>
      <td>IP地址信息</td>
    </tr>
    <tr>
      <td>ip_credit.addr[0].province</td>
      <td>string</td>
      <td>-</td>
      <td>省份</td>
    </tr>
    <tr>
      <td>ip_credit.addr[0].city</td>
      <td>string</td>
      <td>-</td>
      <td>城市</td>
    </tr>
    <tr>
      <td>ip_credit.addr[0].district</td>
      <td>string</td>
      <td>-</td>
      <td>地区</td>
    </tr>
    <tr>
      <td>ip_credit.addr[0].country</td>
      <td>string</td>
      <td>-</td>
      <td>国家</td>
    </tr>
    <tr>
      <td>ip_credit.addr[0].location</td>
      <td>object</td>
      <td>-</td>
      <td>IP地理位置信息</td>
    </tr>
    <tr>
      <td>ip_credit.addr[0].location.latitude</td>
      <td>float</td>
      <td>-</td>
      <td>IP的纬度</td>
    </tr>
    <tr>
      <td>ip_credit.addr[0].location.radius</td>
      <td>float</td>
      <td>-</td>
      <td>IP覆盖范围半径，单位：KM</td>
    </tr>
    <tr>
      <td>ip_credit.addr[0].location.longitude</td>
      <td>float</td>
      <td>-</td>
      <td>IP的经度</td>
    </tr>
    <tr>
      <td>ip_credit.addr[0].idc</td>
      <td>string</td>
      <td>-</td>
      <td>机房或网络运营商</td>
    </tr>
    <tr>
      <td>ip_credit.addr[0].accuracy</td>
      <td>enum</td>
      <td>[“洲”,”国家”,”省”,”城市”,”区县”,”街道”]</td>
      <td>地理位置的精确度</td>
    </tr>
    <tr>
      <td>ip_credit.cache_at</td>
      <td>int</td>
      <td>-</td>
      <td>内部临时数据，可忽略</td>
    </tr>
    <tr>
      <td>ip_credit.export_score</td>
      <td>string</td>
      <td>-</td>
      <td>内部临时数据，可忽略</td>
    </tr>
    <tr>
      <td>ip_credit.ip</td>
      <td>string</td>
      <td>-</td>
      <td>返回的IP,如果</td>
    </tr>
    <tr>
      <td>ip_credit.credit</td>
      <td>object</td>
      <td>-</td>
      <td>IP信用数据</td>
    </tr>
    <tr>
      <td>ip_credit.credit.user_count</td>
      <td>int</td>
      <td>[1-9]</td>
      <td>人数范围标识：’1’:’1’，’2’:’2-5’，’3’:’6-10’，’4’:’11-30’，’5’:’31-50’，’6’:’51-100’，’7’:’101-500’，’8’:’501-2000’，’9’:’2000+’</td>
    </tr>
    <tr>
      <td>ip_credit.credit.office</td>
      <td>float</td>
      <td>[0-100]</td>
      <td>当前IP为办公网的概率</td>
    </tr>
    <tr>
      <td>ip_credit.credit.family</td>
      <td>float</td>
      <td>[0-100]</td>
      <td>当前IP为住宅小区的概率</td>
    </tr>
    <tr>
      <td>ip_credit.credit.export_ip</td>
      <td>float</td>
      <td>[0-100]</td>
      <td>当前IP为人群出口的概率</td>
    </tr>
    <tr>
      <td>ip_credit.credit.person</td>
      <td>float</td>
      <td>[0-100]</td>
      <td>当前IP为真人的概率</td>
    </tr>
    <tr>
      <td>ip_credit.credit.dirty</td>
      <td>float</td>
      <td>[0-100]</td>
      <td>当前IP的污点概率</td>
    </tr>
    <tr>
      <td>ip_credit.credit.active</td>
      <td>float</td>
      <td>[0-100]</td>
      <td>当前IP的活跃度</td>
    </tr>
    <tr>
      <td>ip_credit.credit.base_station</td>
      <td>float</td>
      <td>[0-100]</td>
      <td>当前IP是基站的概率</td>
    </tr>
    <tr>
      <td>ip_credit.credit.edu_station</td>
      <td>float</td>
      <td>[0-100]</td>
      <td>当前IP是教育网的概率</td>
    </tr>
    <tr>
      <td>ip_credit.is_virus</td>
      <td>enum</td>
      <td>[“yes”,”no”]</td>
      <td>传入IP是否有病毒标签</td>
    </tr>
    <tr>
      <td>ip_credit.is_abuse</td>
      <td>enum</td>
      <td>[“yes”,”no”]</td>
      <td>传入IP是否有恶意活动标签</td>
    </tr>
    <tr>
      <td>ip_credit.is_spider</td>
      <td>enum</td>
      <td>[“yes”,”no”]</td>
      <td>传入IP是否有爬虫标签</td>
    </tr>
    <tr>
      <td>ip_credit.is_spam</td>
      <td>enum</td>
      <td>[“yes”,”no”]</td>
      <td>传入IP是否有垃圾邮件标签</td>
    </tr>
    <tr>
      <td>ip_credit.is_legal</td>
      <td>enum</td>
      <td>[“yes”,”no”]</td>
      <td>传入IP是否符合语法标准</td>
    </tr>
    <tr>
      <td>ip_credit.is_black</td>
      <td>enum</td>
      <td>[“yes”,”no”]</td>
      <td>传入IP是否为高危IP</td>
    </tr>
    <tr>
      <td>ip_credit.is_data_center</td>
      <td>enum</td>
      <td>[“yes”,”no”]</td>
      <td>传入IP是否为数据中心IP</td>
    </tr>
    <tr>
      <td>ip_credit.is_proxy</td>
      <td>enum</td>
      <td>[“yes”,”no”]</td>
      <td>传入IP是否为代理IP</td>
    </tr>
    <tr>
      <td>ip_credit.is_tor</td>
      <td>enum</td>
      <td>[“yes”,”no”]</td>
      <td>传入IP是否为洋葱路由IP</td>
    </tr>
    <tr>
      <td>ip_credit.is_wangba</td>
      <td>enum</td>
      <td>[“yes”,”no”]</td>
      <td>传入IP是否为网吧IP</td>
    </tr>
    <tr>
      <td>ip_credit.trend</td>
      <td>array</td>
      <td>-</td>
      <td>威胁趋势</td>
    </tr>
    <tr>
      <td>ip_credit.trend[0][0]</td>
      <td>int</td>
      <td>-</td>
      <td>日期0点时间戳</td>
    </tr>
    <tr>
      <td>ip_credit.trend[0][1]</td>
      <td>int</td>
      <td>-</td>
      <td>记录数量</td>
    </tr>
    <tr>
      <td>ip_credit.trend[0][2]</td>
      <td>enum</td>
      <td>[“low”,”medium”,”high”,null]</td>
      <td>威胁等级</td>
    </tr>
    <tr>
      <td>ip_credit.score</td>
      <td>enum</td>
      <td>[“low”,”medium”,”high”,null]</td>
      <td>威胁等级</td>
    </tr>
    <tr>
      <td>ip_credit.type</td>
      <td>dict</td>
      <td>-</td>
      <td>历史威胁事件名称和计数的key-val对</td>
    </tr>
    <tr>
      <td>ip_credit.latest</td>
      <td>array</td>
      <td>-</td>
      <td>近期威胁事件记录</td>
    </tr>
    <tr>
      <td>ip_credit.latest[0].timestamp</td>
      <td>int</td>
      <td>-</td>
      <td>更新时间戳</td>
    </tr>
    <tr>
      <td>ip_credit.latest[0].hits</td>
      <td>int</td>
      <td>-</td>
      <td>命中次数</td>
    </tr>
    <tr>
      <td>ip_credit.latest[0].score</td>
      <td>enum</td>
      <td>[“low”,”medium”,”high”,null]</td>
      <td>威胁等级</td>
    </tr>
    <tr>
      <td>ip_credit.latest[0].type</td>
      <td>string</td>
      <td>-</td>
      <td>威胁事件名称</td>
    </tr>
    <tr>
      <td>ip_credit.latest[0].loc</td>
      <td>string</td>
      <td>-</td>
      <td>攻击源地理位置</td>
    </tr>
    <tr>
      <td>ip_tag</td>
      <td>array</td>
      <td>-</td>
      <td>IP的标签，等同于src_ip_tag和dst_ip_tag</td>
    </tr>
    <tr>
      <td>direction</td>
      <td>enum</td>
      <td>[“PRIVATE_PRIVATE”,”PRIVATE_PUBLIC”,”PUBLIC_PRIVATE”,”PUBLIC_PUBLIC”]</td>
      <td>攻击方向描述</td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p>说明：<br />
在ATD中，当某IP的人群出口IP概率值（export_ip）大于60时，认为是人群出口IP。</p>
</blockquote>

<h3 id="2-response-body数据样例">2. response body数据样例</h3>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"code"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nl">"msg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"success"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p><strong>字段解释：</strong></p>

<table>
  <thead>
    <tr>
      <th>字段名</th>
      <th>类型</th>
      <th>取值范围</th>
      <th>解释</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>code</td>
      <td>int</td>
      <td>-</td>
      <td>调⽤结果， 0表示成功，⾮0表示失败</td>
    </tr>
    <tr>
      <td>msg</td>
      <td>string</td>
      <td>-</td>
      <td>提示信息</td>
    </tr>
    <tr>
      <td>data</td>
      <td>array</td>
      <td>-</td>
      <td>⽤于返回结果数据，这⾥填空数组即可</td>
    </tr>
  </tbody>
</table>

<h3 id="3-调用示例">3. 调用示例</h3>

<blockquote>
  <p>说明：<br />
1、在验证时，我们将向您发送如上样例的POST数据包；<br />
2、如果在3秒内返回结果，并且（1）返回的数据为JSON格式；（2）code值为0，则将验证通过。<br /></p>
</blockquote>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[root@bs203 ~]# curl http://172.18.1.203:8001/v1/firewall/action -d '
[{
    "timestamp": 1589990781,
    "location": "10.10.17.2",
    "action": "",
    "event": {
        "name": "Misc攻击",
        "type": "bro",
        "reason": "Misc攻击",
        "description": "ET CHAT IRC PING command",
        "policy": 0,
        "level": 3,
        "rule": "alert tcp any 6666:7000 -&gt; any any (msg:\"ET CHAT IRC PING command\"; flow:from_server,established; content:\"PING|20|\"; flowbits:set,is_proto_irc; reference:url,doc.emergingthreats.net/2002027; classtype:misc-activity; sid:2002027; rev:16; metadata:created_at 2010_07_30, updated_at 2010_07_30;)",
        "content": {
            "destIP": "10.47.7.152",
            "destPort": 50981,
            "illegalIP": "10.10.17.2",
            "proto": "TCP",
            "srcIP": "10.10.17.2",
            "srcPort": 6667
        },
        "suspicious_text": [
            "PING "
        ]
    },
    "time_local": "2020-05-21T00:06:21+0800",
    "ip_credit": "{\"is_legal\": \"yes\", \"is_local\": \"yes\", \"latest\": [], \"trend\": [[1587312000, 0, null], [1587398400, 0, null]], \"score\": null, \"ip\": \"10.10.17.2\", \"addr\": [], \"search_engine\": {\"name\": \"\", \"status\": \"\"}, \"credit\": {\"is_local\": \"yes\"}, \"services\": [], \"tag_list\": [], \"ports\": [], \"type\": {}, \"export_score\": \"60\", \"cache_at\": 1589958140}",
    "ip_tag": [
        "local"
    ],
    "src_ip_credit": "{\"is_legal\": \"yes\", \"is_local\": \"yes\", \"latest\": [], \"trend\": [[1587312000, 0, null], [1587398400, 0, null]], \"score\": null, \"ip\": \"10.10.17.2\", \"addr\": [], \"search_engine\": {\"name\": \"\", \"status\": \"\"}, \"credit\": {\"is_local\": \"yes\"}, \"services\": [], \"tag_list\": [], \"ports\": [], \"type\": {}, \"export_score\": \"60\", \"cache_at\": 1589958140}",
    "src_ip_tag": [
        "local"
    ],
    "dst_ip_credit": "{\"is_legal\": \"yes\", \"is_local\": \"yes\", \"latest\": [], \"trend\": [[1587312000, 0, null], [1587398400, 0, null]], \"score\": null, \"ip\": \"10.47.7.152\", \"addr\": [], \"search_engine\": {\"name\": \"\", \"status\": \"\"}, \"credit\": {\"is_local\": \"yes\"}, \"services\": [], \"tag_list\": [], \"ports\": [], \"type\": {}, \"export_score\": \"60\", \"cache_at\": 1589958140}",
    "dst_ip_tag": [
        "local"
    ],
    "direction": "PRIVATE_PRIVATE"
}]'
</code></pre></div></div>
<h3 id="4-返回样例">4. 返回样例</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
    "msg": "success", 
    "code": 0, 
    "data": []
}
</code></pre></div></div>

			</article>
		</section>

		<script>
			document.getElementById("open-nav").addEventListener("click", function () {
				document.body.classList.toggle("nav-open");
			});
		</script>
	</body>
</html>
