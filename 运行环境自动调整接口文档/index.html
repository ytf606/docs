<!DOCTYPE html>

<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">


		<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Merriweather:400,400italic,700,700italic|Open+Sans:400,400italic,600,600italic,700,700italic|Inconsolata:400,700">
		<link rel="stylesheet" href="/docs/css/main.css">
		<link rel="apple-touch-icon" href="/docs/images/apple-touch-icon.png">
		<link rel="icon" type="image/png" href="/docs/images/touch-icon.png" sizes="192x192">
		<link rel="icon" type="image/png" href="/docs/images/favicon.png">

		
	</head>

	<body>
		<header>
			<h1>
				<a href="/docs/"><img src="/docs/images/emblem.svg" width="40" height="40" alt="ATD文档中心 logo"></a>
				ATD文档中心
				<button type="button" class="open-nav" id="open-nav"></button>
			</h1>
			<!--
			<form action="/docs/search/" method="get">
				<input type="text" name="q" id="search-input" placeholder="搜索" autofocus>
				<input type="submit" value="search" style="display: none;">
			</form>
		-->
			<nav class="full-navigation">
				<ul>
					<li class="nav-item top-level ">
						
						<a href="/docs/">ATD新手入门文档</a>
					</li>
				</ul>

				<ul>
					
					
						<li class="nav-item "><a href="/docs/%E9%AB%98%E7%BA%A7%E8%AE%A1%E7%AE%97%E6%A8%A1%E5%BC%8F%E7%9A%84%E7%AD%96%E7%95%A5%E8%AE%BE%E7%BD%AE/">高级计算模式的策略设置</a></li>
					
						<li class="nav-item "><a href="/docs/%E9%AB%98%E7%BA%A7%E6%90%9C%E7%B4%A2%E8%AF%B4%E6%98%8E%E6%96%87%E6%A1%A3/">高级搜索说明文档</a></li>
					
						<li class="nav-item "><a href="/docs/%E5%87%A0%E7%A7%8D%E6%8E%A8%E6%97%A5%E5%BF%97%E6%96%B9%E5%BC%8F%E4%BB%8B%E7%BB%8D/">几种推日志方式介绍</a></li>
					
						<li class="nav-item "><a href="/docs/%E5%8F%AF%E7%BC%96%E7%A8%8B%E5%AF%B9%E6%8A%97-%E9%AB%98%E7%BA%A7%E8%A7%84%E5%88%99/">可编程对抗-高级规则</a></li>
					
						<li class="nav-item "><a href="/docs/%E5%8F%AF%E7%BC%96%E7%A8%8B%E5%AF%B9%E6%8A%97%E6%A8%A1%E5%9E%8B%E8%AF%B4%E6%98%8E%E6%96%87%E6%A1%A3/">可编程对抗模型说明文档</a></li>
					
						<li class="nav-item "><a href="/docs/%E8%BD%AE%E8%AF%A2%E5%91%A8%E6%9C%9F%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3/">轮询周期使用文档</a></li>
					
						<li class="nav-item "><a href="/docs/%E5%86%85%E7%BD%91%E8%87%AA%E5%AE%9A%E4%B9%89%E5%A4%84%E7%90%86%E6%8E%A5%E5%8F%A3%E6%96%87%E6%A1%A3/">内网自定义处理接口文档</a></li>
					
						<li class="nav-item "><a href="/docs/%E6%97%A5%E5%BF%97%E9%85%8D%E7%BD%AE%E6%96%87%E6%A1%A3/">日志配置文档</a></li>
					
						<li class="nav-item "><a href="/docs/%E7%AE%97%E6%B3%95%E6%A8%A1%E5%9E%8B%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3/">算法模型开发文档</a></li>
					
						<li class="nav-item "><a href="/docs/%E5%BE%AE%E4%BF%A1%E5%91%8A%E8%AD%A6%E5%AF%B9%E6%8E%A5%E6%93%8D%E4%BD%9C%E6%96%87%E6%A1%A3/">微信告警对接操作文档</a></li>
					
						<li class="nav-item "><a href="/docs/%E9%92%89%E9%92%89%E5%91%8A%E8%AD%A6%E5%AF%B9%E6%8E%A5%E6%93%8D%E4%BD%9C%E6%96%87%E6%A1%A3/">钉钉告警对接操作文档</a></li>
					
						<li class="nav-item current"><a href="/docs/%E8%BF%90%E8%A1%8C%E7%8E%AF%E5%A2%83%E8%87%AA%E5%8A%A8%E8%B0%83%E6%95%B4%E6%8E%A5%E5%8F%A3%E6%96%87%E6%A1%A3/">运行环境自动调整接口文档</a></li>
					
						<li class="nav-item "><a href="/docs/%E6%89%A7%E8%A1%8C%E5%8A%A8%E4%BD%9C%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3/">执行动作使用文档</a></li>
					
						<li class="nav-item "><a href="/docs/%E6%99%BA%E8%83%BD%E6%97%A5%E5%BF%97%E8%A7%A3%E6%9E%90/">智能日志解析</a></li>
					
						<li class="nav-item "><a href="/docs/%E8%B5%84%E4%BA%A7%E5%8F%91%E7%8E%B0/">资产发现</a></li>
					
						<li class="nav-item "><a href="/docs/%E8%87%AA%E5%AE%9A%E4%B9%89%E5%A4%84%E7%90%86%E6%96%B9%E5%BC%8F%E6%8E%A5%E5%8F%A3%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3/">自定义处理方式接口开发文档</a></li>
					
						<li class="nav-item "><a href="/docs/%E6%94%BB%E5%87%BB%E7%B1%BB%E5%9E%8B/">攻击类型</a></li>
					
						<li class="nav-item "><a href="/docs/FAQ/">FAQ</a></li>
					
				</ul>

			</nav>
		</header>

		<section class="main">
			<div class="page-header">
				<h2>ATD文档中心</h2>
				<h3>运行环境自动调整接口文档</h3>
			</div>
			<article class="content">
				<h3 id="说明">说明</h3>
<blockquote>
  <p>接口以GET方式调用，返回json格式数据，数据中只包含存活且可用的机器列表。调用频率1分钟一次，如果接口调用失败，维持原有集群状态不变。</p>
</blockquote>

<h3 id="注意事项">注意事项</h3>
<blockquote>
  <ol>
    <li>对于将缩容的机器，接口需在机器宕机之前大于10分钟就已对接口的数据进行更新，保证ATD平滑自动缩容</li>
    <li>对于将扩容的机器，接口需在机器正常开启10分钟之后对接口的数据进行更新，保证ATD平滑自动扩容</li>
  </ol>
</blockquote>

<h3 id="1-response-body数据样例">1. response body数据样例</h3>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"code"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nl">"msg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"success"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ip_addr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"192.168.0.1"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"ssh_port"</span><span class="p">:</span><span class="w"> </span><span class="mi">22</span><span class="p">,</span><span class="w">
    </span><span class="nl">"ssh_user"</span><span class="p">:</span><span class="w"> </span><span class="s2">"root"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"ssh_pass"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123456"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ip_addr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"192.168.0.2"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"ssh_port"</span><span class="p">:</span><span class="w"> </span><span class="mi">22</span><span class="p">,</span><span class="w">
    </span><span class="nl">"ssh_user"</span><span class="p">:</span><span class="w"> </span><span class="s2">"root"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"ssh_pass"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123456"</span><span class="w">   
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ip_addr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"192.168.0.3"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"ssh_port"</span><span class="p">:</span><span class="w"> </span><span class="mi">22</span><span class="p">,</span><span class="w">
    </span><span class="nl">"ssh_user"</span><span class="p">:</span><span class="w"> </span><span class="s2">"root"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"ssh_pass"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123456"</span><span class="w">
  </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p><strong>字段解释：</strong></p>

<table>
  <thead>
    <tr>
      <th>字段名</th>
      <th>类型</th>
      <th>取值范围</th>
      <th>解释</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>code</td>
      <td>int</td>
      <td>-</td>
      <td>调用结果， 0表示成功，1表示失败</td>
    </tr>
    <tr>
      <td>msg</td>
      <td>string</td>
      <td>-</td>
      <td>提示信息</td>
    </tr>
    <tr>
      <td>data</td>
      <td>array</td>
      <td>-</td>
      <td>用于返回存活机器的列表，ATD扩缩容机器需要root登录权限，若登录无需密码，可不填写ssh_pass该key</td>
    </tr>
  </tbody>
</table>

<h3 id="2-调用示例">2. 调用示例</h3>

<blockquote>
  <p>说明：<br />
1、在验证时，我们将会调用如上样例的接口请求数据；<br />
2、如果10s内返回结果，并且（1）返回的数据为如上格式；（2）code值为0，则将验证通过。<br /></p>
</blockquote>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[root@bs203 ~]# curl http://172.18.1.203:8001/system/alive 

{
  "code": 0,
  "msg": "success",
  "data": [
  {
    "ip_addr": "192.168.0.1",
    "ssh_port": 22,
    "ssh_user": "root",
    "ssh_password": "123456"
  },
  {
    "ip_addr": "192.168.0.2",
    "ssh_port": 22,
    "ssh_user": "root",
    "ssh_password": "123456"   
  },
  {
    "ip_addr": "192.168.0.3",
    "ssh_port": 22,
    "ssh_user": "root",
    "ssh_password": "123456"
  }
  ]
}
</code></pre></div></div>

			</article>
		</section>

		<script>
			document.getElementById("open-nav").addEventListener("click", function () {
				document.body.classList.toggle("nav-open");
			});
		</script>
	</body>
</html>
